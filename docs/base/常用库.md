- [sys](#sys)
- [psycopg2](#psycopg2)
- [excel](#excel)

****

# <a id="sys">sys</a>

sys模块是系统相关模块，主要包含以下函数：

- **sys.argv**: 实现从程序外部向程序传递参数
- **sys.exit([arg])**: 程序退出，arg=0为正常退出。
- sys.stdout.write('please:'):标准输出，引出进度条的例子
- sys.getrecursionlimit() :获取最大递归层数
- sys.setrecursionlimit(1200):设置最大递归层数
- sys.getdefaultencoding(): 获取系统当前编码，一般默认为ascii。
- sys.setdefaultencoding(): 设置系统默认编码，执行dir（sys）时不会看到这个方法，在解释器中执行不通过，可以先执行reload(sys)，在执行 setdefaultencoding('utf8')，此时将系统默认编码设置为utf8。
- sys.getfilesystemencoding(): 获取文件系统使用编码方式，Windows下返回'mbcs'，mac下返回'utf-8'.
- **sys.path**: 获取指定模块搜索路径的字符串集合，可以将写好的模块放在得到的某个路径下，就可以在程序中import时正确找到。
- **sys.platform**: 获取当前系统平台。
- **sys.stdin,sys.stdout,sys.stderr**: stdin , stdout , 以及stderr 变量包含与标准I/O 流对应的流对象. 如果需要更好地控制输出,而print 不能满足你的要求, 它们就是你所需要的. 你也可以替换它们, 这时候你就可以重定向输出和输入到其它设备( device ), 或者以非标准的方式处理它们

- **sys.modules**:`sys.modules`是一个全局字典，该字典是python启动后就加载在内存中。每当程序员导入新的模块，`sys.modules`将自动记录该模块。当第二次再导入该模块时，python会直接到字典中查找，从而加快了程序运行的速度。它拥有字典所拥有的一切方法。

```python
import sys
import data_db

print(sys.modules.items())
print(sys.argv)
print(type(sys.argv))

--------------------------------
dict_items([('sys', <module 'sys' (built-in)>),...])
['C:/Users/67409/Deskto/th-collection/sys.py']
<class 'list'>
--------------------------------

python sys.py 123 456
['sys.py', '123','456']
```

# <a id="psycopg2">psycopg2</a>

psycopg2模块可以让Python操作postgresql数据库。

- 安装Python操作pg的包：psycopg2

> pip install psycopg2

- 操作示例

```python
import psycopg2

# 创建连接对象
conn = psycopg2.connect(database="postgres", user="postgres", password="123456", host="localhost", port="5432")
# 获取游标
cur = conn.cursor()
# 执行SQL
cur.execute("select * from user_info")
# 获取结果 返回元组
res = cur.fetchall()
print(res)
# 提交事务
conn.commit()
# 关闭连接
cur.close()
conn.close()

[(1, 'Jack', '123456', '17629154002'), (2, 'Jack2', '123456', '17629154003'), (3, 'Jack3', '123456', '17629154004'), (4, 'Jack4', '123456', '17629154005'), (5, 'Jack5', '123456', '17629154006'), (6, 'unknow', '123456', '17629154008')]
```

# <a id="excel">excel</a>

Python操作Excel的库众多，常用有以下几种：

- xlrd库：从excel中读取数据，支持xls、xlsx
- xlwt库：向excel中写入数据
- xlutils库：修改excel数据
- openpyxl：主要针对xlsx格式的excel进行读取和编辑

****

**xlwt示例**

- 安装xlwt：pip install xlwt

```python
import xlwt

# 创建Excel对象
excel = xlwt.Workbook()
# 添加页面
sheet = excel.add_sheet('user_info')
sheet.write(0, 0, '用户ID')
sheet.write(0, 1, '用户名')
sheet.write(0, 2, '用户密码')

users_info = [
    [1, 'Jack', '123456'],
    [2, 'Mary', '984264'],
    [3, 'Merry', '200481'],
    [4, 'Lucy', '89100']
]

# 添加用户数据
line = 1
for user in users_info:
    col = 0
    for field in user:
        sheet.write(line, col, field)
        col += 1
    line += 1

# 保存Excel
excel.save('user_infos.xls')
```

**xlrd示例**

- 安装xlrd：pip install xlrd

```python
import xlrd

# 打开excel
excel = xlrd.open_workbook('user_infos.xls')
# 获取sheet
sheet = excel.sheet_by_index(0)
# sheet = excel.sheet_by_name('user_info')
# 输出多少行 多少列
print('一共有{}行，{}列'.format(sheet.nrows, sheet.ncols))
# 获取某个位置的值
print('第二行第二列的值是{}'.format(sheet.cell(1, 1).value))
# 获取整行整列的值
print('第一行的所有值为：{}'.format(sheet.row_values(0)))
print('第一列的所有值为：{}'.format(sheet.col_values(0)))
# 输出所有值
for i in range(sheet.nrows):
    print(sheet.row_values(i))

一共有5行，3列
第二行第二列的值是Jack
第一行的所有值为：['用户ID', '用户名', '用户密码']
第一列的所有值为：['用户ID', 1.0, 2.0, 3.0, 4.0]
['用户ID', '用户名', '用户密码']
[1.0, 'Jack', '123456']
[2.0, 'Mary', '984264']
[3.0, 'Merry', '200481']
[4.0, 'Lucy', '89100']
```

**xlutils示例**

- 安装xlutils：pip install xlutils

```python
import xlrd
from xlutils import copy

# xlrd读取一个excel
excel = xlrd.open_workbook('user_infos.xls')
# xlutils复制一份之前的excel
new_excel = copy.copy(excel)
# 获取sheet
sheet = new_excel.get_sheet(0)
# 修改数据
sheet.write(1, 1, 'Rocks')
# 保存
new_excel.save('new_user_infos.xls')
```
